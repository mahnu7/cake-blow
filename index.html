<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Happy Birthday Sawaiz ðŸŽ‚</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      background: linear-gradient(135deg, #3f2b96, #a8c0ff);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      color: white;
      text-align: center;
    }

    h1 {
      font-size: 1.5rem;
      margin-bottom: 20px;
    }

    .cake {
      position: relative;
      width: 300px;
      height: 150px;
      background: radial-gradient(circle at center, #6a0dad, #4b0082);
      border-radius: 50% / 20%;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      padding-top: 20px;
    }

    .candle {
      position: relative;
      width: 6px;
      height: 40px;
      background: sienna;
      margin: 0 5px;
      display: flex;
      justify-content: center;
    }

    .flame {
      position: absolute;
      top: -12px;
      width: 10px;
      height: 15px;
      background: radial-gradient(circle, gold, orange, red);
      border-radius: 50%;
      animation: flicker 0.2s infinite alternate;
    }

    @keyframes flicker {
      from { transform: scale(1) translateY(0); opacity: 0.9; }
      to   { transform: scale(1.2) translateY(-2px); opacity: 0.7; }
    }

    .hidden {
      display: none;
    }

    #confetti {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 999;
    }
  </style>
</head>
<body>
  <h1 id="message">Sending you my love all the way Hyderabad to Lahore. Make a wish.</h1>
  <div class="cake" id="cake"></div>
  <canvas id="confetti"></canvas>

  <script>
    const cake = document.getElementById("cake");
    const message = document.getElementById("message");
    const confettiCanvas = document.getElementById("confetti");
    const ctx = confettiCanvas.getContext("2d");

    let numCandles = 27; // ðŸŽ‚ Change this number if needed
    let flamesOut = 0;

    // Add candles dynamically
    for (let i = 0; i < numCandles; i++) {
      const candle = document.createElement("div");
      candle.classList.add("candle");

      const flame = document.createElement("div");
      flame.classList.add("flame");

      candle.appendChild(flame);
      cake.appendChild(candle);
    }

    // Microphone detection
    navigator.mediaDevices.getUserMedia({ audio: true })
      .then(stream => {
        const audioContext = new AudioContext();
        const source = audioContext.createMediaStreamSource(stream);
        const analyser = audioContext.createAnalyser();
        source.connect(analyser);

        const dataArray = new Uint8Array(analyser.fftSize);

        function detectBlow() {
          analyser.getByteFrequencyData(dataArray);
          let volume = dataArray.reduce((a, b) => a + b) / dataArray.length;

          if (volume > 30) { // adjust sensitivity
            blowOutCandle();
          }

          requestAnimationFrame(detectBlow);
        }

        detectBlow();
      });

    function blowOutCandle() {
      const flames = document.querySelectorAll(".flame:not(.hidden)");
      if (flames.length > 0) {
        flames[0].classList.add("hidden");
        flamesOut++;

        if (flamesOut === numCandles) {
          showConfetti();
          message.innerText = "May your 27th be as special as this cake <3";
        }
      }
    }

    // Simple confetti
    confettiCanvas.width = window.innerWidth;
    confettiCanvas.height = window.innerHeight;
    let confettiPieces = [];

    function showConfetti() {
      for (let i = 0; i < 200; i++) {
        confettiPieces.push({
          x: Math.random() * confettiCanvas.width,
          y: Math.random() * confettiCanvas.height - confettiCanvas.height,
          r: Math.random() * 6 + 4,
          d: Math.random() * 20 + 10,
          color: `hsl(${Math.random() * 360},100%,50%)`,
          tilt: Math.random() * 10 - 10
        });
      }
      drawConfetti();
    }

    function drawConfetti() {
      ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      confettiPieces.forEach(p => {
        ctx.beginPath();
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x, p.y, p.r, p.r);
        ctx.fill();
        p.y += p.d * 0.05;
        p.x += Math.sin(p.tilt);
        if (p.y > confettiCanvas.height) {
          p.y = -10;
          p.x = Math.random() * confettiCanvas.width;
        }
      });
      requestAnimationFrame(drawConfetti);
    }
  </script>
</body>
</html>

